
<div align="center">

# –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ —Å–≤—è–∑–∏  

**–§–ï–î–ï–†–ê–õ–¨–ù–û–ï –ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–û–ï –ë–Æ–î–ñ–ï–¢–ù–û–ï  
–û–ë–†–ê–ó–û–í–ê–¢–ï–õ–¨–ù–û–ï –£–ß–†–ï–ñ–î–ï–ù–ò–ï –í–´–°–®–ï–ì–û –û–ë–†–ê–ó–û–í–ê–ù–ò–Ø**  

**¬´–°–ê–ù–ö–¢-–ü–ï–¢–ï–†–ë–£–†–ì–°–ö–ò–ô –ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–´–ô –£–ù–ò–í–ï–†–°–ò–¢–ï–¢  
–¢–ï–õ–ï–ö–û–ú–ú–£–ù–ò–ö–ê–¶–ò–ô –ò–ú. –ü–†–û–§. –ú. –ê. –ë–û–ù–ß-–ë–†–£–ï–í–ò–ß–ê¬ª (–°–ü–±–ì–£–¢)**  

</div>

<div align="center">
–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏  
–ö–∞—Ñ–µ–¥—Ä–∞: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –≤ –∫–∏–±–µ—Ä—Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö  
<br><br>


## –ö—É—Ä—Å–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç
–ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ **¬´–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Å–µ—Ç—è—Ö —Å–≤—è–∑–∏¬ª**  
## **–¢–µ–º–∞:** –†–∞—Å—á–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏ 
</div>

<div align="right"><br>

**–í—ã–ø–æ–ª–Ω–∏–ª:**  
–°—Ç—É–¥–µ–Ω—Ç –≥—Ä—É–ø–ø—ã –ò–ö–ü–ò-42  
–¢–µ—Ä–µ—â–µ–Ω–∫–æ –ú. –ê.  

**–ü–æ–¥–ø–∏—Å—å** ______________

**–ü—Ä–∏–Ω—è–ª:**  
–∫.—Ç.–Ω., –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä—ã –°–° –∏ –ü–î
–ì—Ä–µ–±–µ–Ω—â–∏–∫–æ–≤–∞ –ê. –ê.
**–ü–æ–¥–ø–∏—Å—å** ______________

</div>
<br>
<div align="center">
<br><br>
–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥  
2025  
</div>

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã](#—Ü–µ–ª—å-—Ä–∞–±–æ—Ç—ã)
- [–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ](#–∏—Å—Ö–æ–¥–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ)
- [–ó–∞–¥–∞–Ω–∏–µ](#–∑–∞–¥–∞–Ω–∏–µ)
- [–†–∞—Å—á—ë—Ç](#—Ä–∞—Å—á—ë—Ç)
  - [4.1 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ –≤ —É–∑–ª–∞—Ö —Å–µ—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞](#41-—Ä–∞—Å—á—ë—Ç-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π-–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ-–≤-—É–∑–ª–∞—Ö-—Å–µ—Ç–∏-—Ç—Ä–∞—Ñ–∏–∫–∞)
  - [4.2 –†–∞—Å—á—ë—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞](#42-—Ä–∞—Å—á—ë—Ç-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-—Ç—Ä–∞—Ñ–∏–∫–∞)
  - [4.3 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏](#43-—Ä–∞—Å—á—ë—Ç-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π-—Ç—Ä–∞—Ñ–∏–∫–∞-–≤-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö-—Å–≤—è–∑–∏)
  - [4.4 –†–∞—Å—á—ë—Ç –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ —Å–µ—Ç–∏](#44-—Ä–∞—Å—á—ë—Ç-–∫—Ä–∞—Ç—á–∞–π—à–∏—Ö-—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π-–∏-–º–∞—Ä—à—Ä—É—Ç–æ–≤-–º–µ–∂–¥—É-—É–∑–ª–∞–º–∏-—Å–µ—Ç–∏)
  - [4.5 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –ª–∏–Ω–∏—è—Ö —Å–≤—è–∑–∏](#45-—Ä–∞—Å—á—ë—Ç-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π-–Ω–∞–≥—Ä—É–∑–æ–∫-–Ω–∞-–ª–∏–Ω–∏—è—Ö-—Å–≤—è–∑–∏)
  - [4.6 –†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤ –≤ –ª–∏–Ω–∏—è—Ö —Å–≤—è–∑–∏](#46-—Ä–∞—Å—á—ë—Ç-–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞-–ø–æ—Ç–æ–∫–æ–≤-–≤-–ª–∏–Ω–∏—è—Ö-—Å–≤—è–∑–∏)
  - [4.7 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –ü–î –¥–ª—è –ª–∏–Ω–∏–π —Å–≤—è–∑–∏](#47-—Ä–∞—Å—á—ë—Ç-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π-—Ç—Ä–∞—Ñ–∏–∫–∞-–ø–¥-–¥–ª—è-–ª–∏–Ω–∏–π-—Å–≤—è–∑–∏)
  - [4.8 –†–∞—Å—á—ë—Ç –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏](#48-—Ä–∞—Å—á—ë—Ç-–ø—Ä–æ–ø—É—Å–∫–Ω–æ–π-—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏-–ª–∏–Ω–∏–π-—Å–≤—è–∑–∏)
- [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏](#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø—Ä–æ–ø—É—Å–∫–Ω–æ–π-—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏-–ª–∏–Ω–∏–π-—Å–≤—è–∑–∏)
- [–í—ã–≤–æ–¥—ã](#–≤—ã–≤–æ–¥—ã)
- [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](#–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)

---

<br><br><br><br><br><br><br>
<br><br><br><br><br><br><br>

## 1. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã  

–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–æ–ø—É—Å–∫–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏ –≤ —Å–µ—Ç–∏ —Å –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏—Ö –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ–º—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è –∑–∞–¥–µ—Ä–∂–∫–∏.

---

## 2. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏:**

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –≤ —Å–µ—Ç–∏ —Å–≤—è–∑–∏ ‚Äì **27**
- –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —É–¥–µ–ª—å–Ω–æ–π –∞–±–æ–Ω–µ–Ω—Ç—Å–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ‚Äì **y‚ÇÄ = 0,1 –≠—Ä–ª**
- –¢–∏–ø –∫–æ–¥–µ–∫–∞ ‚Äì **G.711**
- –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞ –¥–ª—è –∫–æ–¥–µ–∫–∞ G.711 ‚Äì **a‚ÇÄ = 85,6 –∫–±–∏—Ç/—Å**
- –î–ª–∏–Ω–∞ –ø–∞–∫–µ—Ç–∞ ‚Äì **L = 200 –±–∞–π—Ç**
- –ù–∞—á–∞–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ –≤–µ–ª–∏—á–∏–Ω–µ –∑–∞–¥–µ—Ä–∂–∫–∏ ‚Äì **T‚ÇÄ = 100 –º—Å = 0,1 —Å**
- –î–æ–ª—è –≤—ã–∑–æ–≤–æ–≤, –æ–±—Å–ª—É–∂–µ–Ω–Ω—ã—Ö —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º ‚Äì **q = 98 %** (p‚ÇÄ = 0,02)

**–¢–∞–±–ª–∏—Ü–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–±–æ–Ω–µ–Ω—Ç–æ–≤ –ø–æ —É–∑–ª–∞–º —Å–µ—Ç–∏:**

| –£–∑–µ–ª | –ö–æ–ª-–≤–æ –∞–±–æ–Ω–µ–Ω—Ç–æ–≤ | –î–æ–ª—è k·µ¢   |
|------|------------------|-----------|
| 1    | 5207             | 0,036     |
| 2    | 9877             | 0,069     |
| 3    | 4981             | 0,035     |
| 4    | 7521             | 0,052     |
| 5    | 8779             | 0,061     |
| 6    | 7058             | 0,049     |
| 7    | 1003             | 0,007     |
| 8    | 5007             | 0,035     |
| 9    | 7912             | 0,055     |
| 10   | 1133             | 0,008     |
| 11   | 1596             | 0,011     |
| 12   | 3019             | 0,021     |
| 13   | 7751             | 0,054     |
| 14   | 4239             | 0,030     |
| 15   | 4664             | 0,032     |
| 16   | 3908             | 0,027     |
| 17   | 4058             | 0,028     |
| 18   | 2646             | 0,018     |
| 19   | 4709             | 0,033     |
| 20   | 2227             | 0,016     |
| 21   | 6986             | 0,049     |
| 22   | 2459             | 0,017     |
| 23   | 8725             | 0,061     |
| 24   | 9061             | 0,063     |
| 25   | 4090             | 0,028     |
| 26   | 5577             | 0,039     |
| 27   | 9333             | 0,065     |

### **–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π** ‚Äì –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ excel —Ñ–∞–π–ª–µ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ 4222. 

![1764277738829](image/report2/1764277738829.png)

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏ —Å–≤—è–∑–∏**  

![1764717477060](image/report2/1764717477060.png){width=500}



---

## –†–∞—Å—á—ë—Ç

### 3.1 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ –≤ —É–∑–ª–∞—Ö —Å–µ—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

–î–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–º–Ω–æ–∂–∏—Ç—å —á–∏—Å–ª–æ –∞–±–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —É–∑–ª–µ –Ω–∞ y0 
**y·µ¢ = N·µ¢ √ó y‚ÇÄ**

–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç —É–∑–ª–æ–≤ (yi):
| n  | y_i   |
|----|-------|
| 1  | 520.7 |
| 2  | 987.7 |
| 3  | 498.1 |
| 4  | 752.1 |
| 5  | 877.9 |
| 6  | 705.8 |
| 7  | 100.3 |
| 8  | 500.7 |
| 9  | 791.2 |
| 10 | 113.3 |
| 11 | 159.6 |
| 12 | 301.9 |
| 13 | 775.1 |
| 14 | 423.9 |
| 15 | 466.4 |
| 16 | 390.8 |
| 17 | 405.8 |
| 18 | 264.6 |
| 19 | 470.9 |
| 20 | 222.7 |
| 21 | 698.6 |
| 22 | 245.9 |
| 23 | 872.5 |
| 24 | 906.1 |
| 25 | 409.0 |
| 26 | 557.7 |
| 27 | 933.3 |

### 3.2 –†–∞—Å—á—ë—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –¥–∞–Ω–Ω—ã–º —É–∑–ª–æ–º, –Ω–∞ —Å—É–º–º–∞—Ä–Ω—É—é –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞, —Å–æ–∑–¥–∞–≤–∞–µ–º—É—é –≤—Å–µ–º–∏ —É–∑–ª–∞–º–∏ —Å–µ—Ç–∏.

**k·µ¢‚±º = y‚±º / Œ£ y·µ¢**

| n  | k_ij     |
|----|----------|
| 1  | 0.036279 |
| 2  | 0.068817 |
| 3  | 0.034705 |
| 4  | 0.052402 |
| 5  | 0.061167 |
| 6  | 0.049176 |
| 7  | 0.006988 |
| 8  | 0.034886 |
| 9  | 0.055126 |
| 10 | 0.007894 |
| 11 | 0.011120 |
| 12 | 0.021035 |
| 13 | 0.054004 |
| 14 | 0.029535 |
| 15 | 0.032496 |
| 16 | 0.027229 |
| 17 | 0.028274 |
| 18 | 0.018436 |
| 19 | 0.032809 |
| 20 | 0.015516 |
| 21 | 0.048674 |
| 22 | 0.017133 |
| 23 | 0.060790 |
| 24 | 0.063131 |
| 25 | 0.028497 |
| 26 | 0.038857 |
| 27 | 0.065027 |

<br><br><br><br>

### 3.3 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏

–ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ
—Ñ–æ—Ä–º—É–ª–µ

$$
\begin{align*}
\mathbf{Y} &= \left[\mathcal{y}_{i,j}\right], \quad i,j=1,\dots,n \\
y_{i,j} &= k_{i,j}y_i, \quad i,j=1,\dots,n
\end{align*}
$$


**–ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏ Y**

![1764718661681](image/report2/1764718661681.png)

### 3.4 –†–∞—Å—á—ë—Ç –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ —Å–µ—Ç–∏

–î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω **–∞–ª–≥–æ—Ä–∏—Ç–º –§–ª–æ–π–¥–∞-–£–æ—Ä—à–µ–ª–ª–∞**.

–ü–æ–ª—É—á–µ–Ω–∞ **–º–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π**: 

![1764718752909](image/report2/1764718752909.png)

<br><br>

**–ú–∞—Ç—Ä–∏—Ü–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É–∑–ª–∞**

![1764718818155](image/report2/1764718818155.png)

–ú–∞—Ç—Ä–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä–∞ —É–∑–ª–æ–≤, –≤—ã—Å—Ç—É–ø–∞—é—â–∏—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ –º–µ–∂–¥—É –ø–∞—Ä–æ–π —É–∑–ª–æ–≤, –æ–±–æ–∑–Ω–∞—á–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –∏ —Å—Ç–æ–ª–±—Ü–æ–º. 

### 3.5 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –ª–∏–Ω–∏—è—Ö —Å–≤—è–∑–∏

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å—é –º–∞—Ç—Ä–∏—Ü—É –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü—ã –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏ —Å–≤—è–∑–∏, –≤—Ö–æ–¥—è—â–µ–π –≤ –Ω–∞–π–¥–µ–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç.

**–ú–∞—Ç—Ä–∏—Ü–∞ –Ω–∞–≥—Ä—É–∑–æ–∫**:
![1764718969379](image/report2/1764718969379.png)

<br><br><br><br>

### 3.6 –†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤ –≤ –ª–∏–Ω–∏—è—Ö —Å–≤—è–∑–∏

–¢—Ä–µ–±—É–µ–º–æ–µ —á–∏—Å–ª–æ –ø–æ—Ç–æ–∫–æ–≤ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Ñ–æ—Ä–º—É–ª—ã –≠—Ä–ª–∞–Ω–≥–∞ –∏
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ–±—Å–ª—É–∂–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫

$$
\begin{align*}
\mathbf{V} &= \left[\mathbf{v}_{i,j}\right], \quad i,j=1,\dots,n \\
\mathbf{v}_{i,j} &= \arg\min_{\mathbf{v}_{i,j}} \left| \rho\big(\widetilde{\mathbf{y}}_{i,j}, \mathbf{v}_{i,j}\big) - \boldsymbol{\rho}_0 \right|, \\
&\qquad\qquad \rho\big(\widetilde{\mathbf{y}}_{i,j}, \mathbf{v}_{i,j}\big) \leq \boldsymbol{\rho}_0
\end{align*}
$$

$$
\begin{align*}
p\big(\widetilde{\mathbf{y}}_{i,j}, \mathbf{v}_{i,j}\big)
&= \frac{\widetilde{\mathbf{y}}_{i,j}^{\;\;\;\mathbf{v}_{i,j}} / {\;\;\;\mathbf{v}_{i,j}}!}{\displaystyle \sum_{k=0}^{\mathbf{v}_{i,j}} \frac{\widetilde{\mathbf{y}}_{i,j}^{\;\;\;k}}{k!}}
\end{align*}
$$

–ü–æ —Ñ–æ—Ä–º—É–ª–µ –≠—Ä–ª–∞–Ω–≥–∞ B —Å p‚ÇÄ = 0,02 –ø–æ–ª—É—á–µ–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤**:
![1764719374934](image/report2/1764719374934.png)

### 3.7 –†–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –ü–î –¥–ª—è –ª–∏–Ω–∏–π —Å–≤—è–∑–∏

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –ª–∏–Ω–∏—è—Ö —Å–≤—è–∑–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–º–Ω–æ–∂–∏—Ç—å –±–∞–∑–æ–≤—É—é –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å ùëé0 –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤.

**a·µ¢‚±º = v·µ¢‚±º √ó a‚ÇÄ = v·µ¢‚±º √ó 85600** –±–∏—Ç/—Å:

![1764719509923](image/report2/1764719509923.png)

### 3.8 –†–∞—Å—á—ë—Ç –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏

–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ–º–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –º–∞—Ç—Ä–∏—Ü—ã —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤–µ–ª–∏—á–∏–Ω–∞ L / T‚ÇÄ

**–ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π (—Ñ—Ä–∞–≥–º–µ–Ω—Ç, –±–∏—Ç/—Å)**  

![1764719586070](image/report2/1764719586070.png)


---

## 4 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø–æ–¥–±–æ—Ä —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ª–∏–Ω–∏–π —Å–≤—è–∑–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —Å–∫–≤–æ–∑–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–º—É—Å—è –∑–Ω–∞—á–µ–Ω–∏—é - **50 –º—Å**. –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —ç—Ç–æ–π —Ü–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∂–∞–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å —à–∞–≥–æ–º ( dc = 10,000 ) –±–∏—Ç/—Å.


**–ê–ª–≥–æ—Ä–∏—Ç–º**:  
1. –ë–µ—Ä—ë–º –Ω–∞—á–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π b·µ¢‚±º (–∏–∑ –ø—É–Ω–∫—Ç–∞ 3.8).  
2. –ü–æ–æ—á–µ—Ä—ë–¥–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–∞–∂–¥—É—é –ª–∏–Ω–∏—é –Ω–∞ dc –∏ —Å—á–∏—Ç–∞–µ–º —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é  
   **O = Œ£ (t·µ¢‚±º ‚Äì 0,05)¬≤** –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º –∞–±–æ–Ω–µ–Ω—Ç–æ–≤.  
3. –í—ã–±–∏—Ä–∞–µ–º –ª–∏–Ω–∏—é, –¥–∞–≤—à—É—é –Ω–∞–∏–±–æ–ª—å—à–µ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ O.  
4. –§–∏–∫—Å–∏—Ä—É–µ–º –ø—Ä–∏—Ä–æ—Å—Ç, –ø–æ–≤—Ç–æ—Ä—è–µ–º –¥–æ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ O.

<br><br><br><br><br><br>

**–ú–∞—Ç—Ä–∏—Ü–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**  
![1764719859432](image/report2/1764719859432.png)

–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 47,7 –º—Å

**–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π**

![1764719803551](image/report2/1764719803551.png)

---

## 5. –í—ã–≤–æ–¥—ã

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Ç—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–æ–ø—É—Å–∫–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª–∏–Ω–∏–π —Å–≤—è–∑–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –∫–∞–Ω–∞–ª–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–µ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–≤–æ–∑–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é.

---

## 6. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã:**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx


def load_data(path_matrix, path_distr, n1=20, n2=40, y0=0.1, n=31, L=200, a0=85600, T0=0.1, q=98, Y_v0=0.2, a_v0=1, a_IoT=150):
    data = pd.read_csv(path_matrix, delimiter=";", index_col=0, decimal=",")
    distribution = pd.read_csv(path_distr, delimiter=",", index_col=0, decimal=".")
    
    try:
        del distribution["Unnamed: 2"]
    except:
        pass
    
    print(distribution)
    sumAbonents = distribution.sum()["–ê–±–æ–Ω–µ–Ω—Ç–æ–≤"]
    print(data)

    return {
        "data": data,
        "distribution": distribution,
        "sumAbonents": sumAbonents,
        "n1": n1, "n2": n2, "y0": y0, "n": n, "L": L, "a0": a0, "T0": T0, "q": q,
        "Y_v0": Y_v0, "a_v0": a_v0, "a_IoT": a_IoT
    }


def intensity_traffic(state, out=False):
    """1. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∏–∑ —É–∑–ª–æ–≤ —Å–µ—Ç–∏ y_i = N_i * y0"""
    dataIntencity = state["distribution"]["–ê–±–æ–Ω–µ–Ω—Ç–æ–≤"] * state["y0"]
    state["dataIntencity"] = dataIntencity
    
    if out:
        print("1. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∏–∑ —É–∑–ª–æ–≤ —Å–µ—Ç–∏:")
        print(dataIntencity)
    
    return dataIntencity


def distribution_coefficients(state, out=False):
    """2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º —Å–≤—è–∑–∏ kij = yj/sum(yi)"""
    sumIntencity = state["sumAbonents"] * state["y0"]
    dataKij = state["dataIntencity"] / sumIntencity
    state["dataKij"] = dataKij
    
    if out:
        print("2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º —Å–≤—è–∑–∏")
        print(dataKij)
    
    return dataKij


def matrix_intensity_traffic(state, out=False):
    """3. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏"""
    # –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ Y[i,j] = y_i * k_ij
    matrixIntencity = pd.DataFrame(
        np.outer(state["dataIntencity"], state["dataKij"]),
        index=state["dataIntencity"].index,
        columns=state["dataKij"].index
    )
    state["matrixIntencity"] = matrixIntencity
    
    if out:
        print("3. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö —Å–≤—è–∑–∏")
        print(matrixIntencity)
    
    return matrixIntencity


def algorhitm_floid(state, out=False):
    """4. –ú–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ + –º–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–µ–π"""
    D = state["data"].copy()
    D.fillna(1e9, inplace=True)
    D.index = D.index.astype(int)
    D.columns = D.columns.astype(int)

    Next = D.copy()

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã Next
    for i in D.index:
        for j in D.index:
            if i != j and D.loc[i,j] < 1e12:
                Next.loc[i,j] = j

    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–ª–æ–π–¥–∞
    for k in D.index:  # –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞
        for i in D.index:  # –Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞
            for j in D.index:  # –∫–æ–Ω–µ—á–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞
                if D.loc[i,k] + D.loc[k,j] < D.loc[i,j]:  # –Ω–∞–π–¥–µ–Ω –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—É—Ç—å
                    D.loc[i,j] = D.loc[i,k] + D.loc[k,j]  # –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
                    Next.loc[i,j] = Next.loc[i,k]  # –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª –Ω–∞ –ø—É—Ç–∏

    matrixNext = Next 
    R = D

    matrixNext.index = matrixNext.index.astype(int)
    matrixNext.columns = matrixNext.columns.astype(int)

    state["R"] = R
    state["matrixNext"] = matrixNext

    if out:
        print("4. –ú–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ –≥—Ä–∞—Ñ–∞ + –º–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–µ–π")
        print("–ö—Ä–∞—Ç—á–∞–π—à–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:")
        print(R)
        print("–ü—É—Ç–∏:")
        print(matrixNext)
    
    return R, matrixNext


def calc_link_load(state, out=False):
    """5. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ª–∏–Ω–∏–∏ —Å–≤—è–∑–∏ Y_tilde"""
    Y = state["matrixIntencity"]
    Next = state["matrixNext"]
    nodes = list(Y.index)  # —É–∑–ª—ã
    n = len(nodes)  # —á–∏—Å–ª–æ —É–∑–ª–æ–≤

    Y_tilde = pd.DataFrame(np.zeros((n,n)), index=nodes, columns=nodes)

    for i in nodes:
        for j in nodes:
            if i == j or Y.loc[i,j] == 0:
                continue
            path = [i]  # –Ω–∞—á–∏–Ω–∞–µ–º –ø—É—Ç—å —Å i
            cur = i  # —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
            while cur != j:  # –∏–¥—ë–º –ø–æ –ø—É—Ç–∏, –ø–æ–∫–∞ –Ω–µ –¥–æ–π–¥—ë–º –¥–æ j
                cur = Next.loc[cur,j]  # —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª –Ω–∞ –ø—É—Ç–∏ –∏–∑ cur –≤ j
                path.append(cur)  # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –ø—É—Ç—å
            
            for u, v in zip(path[:-1], path[1:]):  # —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–∞—Ñ–∏–∫ –ø–æ —Ä—ë–±—Ä–∞–º
                Y_tilde.loc[u,v] += Y.loc[i,j]  # –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Ä–µ–±—Ä–æ u->v

    state["matrixNagruzka"] = Y_tilde

    if out:
        print("#5. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –ª–∏–Ω–∏–∏ —Å–≤—è–∑–∏")
        print(Y_tilde)

    return Y_tilde


def matrix_v(state, out=False):
    """6. –ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Ç–æ–∫–æ–≤ (—á–∏—Å–ª–æ –∫–∞–Ω–∞–ª–æ–≤)"""
    Y_tilde_sym = state["matrixNagruzka"].copy()
    line_load = pd.DataFrame(0.0, index=Y_tilde_sym.index, columns=Y_tilde_sym.columns) 
    
    # –î–µ–ª–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É –Ω–∞–≥—Ä—É–∑–æ–∫ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π
    for i in Y_tilde_sym.index:
        for j in Y_tilde_sym.columns:
            if i >= j:
                continue
            total_load = Y_tilde_sym.loc[i, j]  
            line_load.loc[i, j] = total_load
            line_load.loc[j, i] = total_load

    V_matrix = pd.DataFrame(0, index=line_load.index, columns=line_load.columns, dtype=int)

    # –¢–æ, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ –∫–∞–Ω–∞–ª–æ–≤, —á—Ç–æ–±—ã –æ–±—Å–ª—É–∂–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚â§ 2%
    for i in line_load.index:
        for j in line_load.columns:
            if i == j:
                continue
            load = line_load.loc[i, j]
            if load > 0:
                v = find_min_channels(load, p_block=(1 - state["q"]/100), max_v=50000)
                V_matrix.loc[i, j] = v
                V_matrix.loc[j, i] = v

    state["V_matrix"] = V_matrix
    if out:
        print("6. –ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Ç–æ–∫–æ–≤")
        print(V_matrix)
    return V_matrix


def matrix_a(state, out=False):
    """7. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ A[i,j]"""
    # A[i,j] = V[i,j] * a0
    A_matrix = state["V_matrix"].astype(float) * state["a0"]
    state["A_matrix"] = A_matrix
    if out:
        print("7. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞")
        print(A_matrix)
    return A_matrix


def matrix_b(state, out=False):
    """8. –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π B[i,j]"""
    # B[i,j] = A[i,j] + (L * 8) / T0
    B_matrix = pd.DataFrame(0, index=state["A_matrix"].index, columns=state["A_matrix"].columns, dtype=int)
    L_bits = state["L"] * 8
    for i in state["A_matrix"].index:
        for j in state["A_matrix"].columns:
            if state["A_matrix"].loc[i, j] == 0:
                continue
            B_matrix.loc[i, j] = state["A_matrix"].loc[i,j] + (L_bits / state["T0"])
    
    state["B_matrix"] = B_matrix
    if out:
        print("8. –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π")
        print(B_matrix)
    return B_matrix


# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

def erlangb(v: int, y: float) -> float:
    if y <= 0: return 0.0
    if v == 0: return 1.0
    inv_b = 1.0
    for i in range(1, v + 1):
        inv_b = 1.0 + inv_b * (i / y)
    return 1.0 / inv_b


def find_min_channels(y: float, p_block: float = 0.02, max_v: int = 50000) -> int:
    # –ò—â–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∫–∞–Ω–∞–ª–æ–≤ v, —á—Ç–æ–±—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚â§ p_block
    # –æ–±—Ä–∞—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –≠—Ä–ª–∞–Ω–≥–∞ B
    if y <= 0: return 0
    if y < 1.0: return 1 # –ø—Ä–∏ –º–∞–ª–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 1 –∫–∞–Ω–∞–ª–∞
    low, high = 1, max_v
    while low < high:
        mid = (low + high) // 2
        if erlangb(mid, y) > p_block:
            low = mid + 1
        else:
            high = mid
    v = low
    while erlangb(v, y) > p_block:
        v += 1
    return v

# –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
def build_paths(state):
    # –°—Ç—Ä–æ–∏–º –ø—É—Ç–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ —É–∑–ª–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Ç—Ä–∏—Ü—ã Next
    nodes = list(state["A_matrix"].index)
    n = len(nodes)
    next_hop = state["matrixNext"].values
    node_to_idx = {node: i for i, node in enumerate(nodes)} # –∫–∞—Ä—Ç–∞ —É–∑–ª–æ–≤ –∫ –∏–Ω–¥–µ–∫—Å–∞–º
    
    paths = [[None] * n for _ in range(n)] # paths[a][b] = —Å–ø–∏—Å–æ–∫ –∏–Ω–¥–µ–∫—Å–æ–≤ —É–∑–ª–æ–≤ –Ω–∞ –ø—É—Ç–∏ –∏–∑ a –≤ b
    for a_idx in range(n):
        for b_idx in range(n):
            if a_idx == b_idx:
                continue
            i = a_idx
            path = [i]
            while i != b_idx:
                next_node = state["matrixNext"].iloc[nodes[i]-1, nodes[b_idx]-1]
                # –ü–µ—Ä–µ–≤–æ–¥–∏–º –Ω–æ–º–µ—Ä —É–∑–ª–∞ –≤ –∏–Ω–¥–µ–∫—Å –≤ —Å–ø–∏—Å–∫–µ paths
                i = node_to_idx[next_node]
                path.append(i)
            paths[a_idx][b_idx] = path
    return paths, nodes, n


def calc_dl(B, A_np, L_bits, paths, n):
    # –í—ã—á–∏—Å–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –∑–∞–¥–µ—Ä–∂–µ–∫ DL
    DEL = L_bits / (B - A_np) 
    # L_bits / (B - A_np) ‚Äî —Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞–∫–µ—Ç –ø–æ —ç—Ç–æ–π –ª–∏–Ω–∏–∏. B - A_np ‚Äî –æ—Å—Ç–∞–≤—à–∞—è—Å—è —Å–≤–æ–±–æ–¥–Ω–∞—è —ë–º–∫–æ—Å—Ç—å
    DEL[np.isinf(DEL)] = 1e9
    DEL[DEL < 0] = 1e9
    DL = np.zeros((n, n), dtype=float)
    for i in range(n):
        for j in range(n):
            if i == j:
                continue
            route = paths[i][j]
            DL[i,j] = sum(DEL[route[k], route[k+1]] for k in range(len(route)-1)) # —Å—É–º–º–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –≤—Å–µ–º —Ä—ë–±—Ä–∞–º –ø—É—Ç–∏
    return DL


def objective_function(B, A_np, L_bits, Topt, paths, n):
    DL = calc_dl(B, A_np, L_bits, paths, n)
    return np.sum((DL - Topt)**2)


def optimization(state, accuracy=0.001, out=False, out_graph_O=False):
    """9. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"""
    Topt = state["T0"] / 2  # —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏
    dc = 10_000  # —à–∞–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
    L_bits = state["L"] * 8  # –¥–ª–∏–Ω–∞ –ø–∞–∫–µ—Ç–∞ –≤ –±–∏—Ç–∞—Ö
    Bo = state["B_matrix"].copy()  # –Ω–∞—á–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
    A_np = state["A_matrix"].values  # –º–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

    paths, nodes, n = build_paths(state)

    default_O = objective_function(state["B_matrix"].values, A_np, L_bits, Topt, paths, n)
    best_O = np.inf
    iteration = 0
    sp_o = []
    sp_iteration = []

    while True:
        iteration += 1
        base_O = objective_function(Bo.values, A_np, L_bits, Topt, paths, n)
        best_edge = None

        for i in nodes:
            for j in nodes:
                if i >= j or Bo.loc[i,j] <= 16000:
                    continue
                Bo.loc[i,j] += dc
                Bo.loc[j,i] += dc
                O_try = objective_function(Bo.values, A_np, L_bits, Topt, paths, n)
                if O_try < best_O:
                    best_O = O_try
                    best_edge = (i,j)
                Bo.loc[i,j] -= dc
                Bo.loc[j,i] -= dc

        if best_edge is None or (base_O - best_O) < accuracy:
            print("\n–£–ª—É—á—à–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")
            break

        i, j = best_edge
        Bo.loc[i,j] += dc
        Bo.loc[j,i] += dc
        sp_o.append(base_O)
        sp_iteration.append(iteration)

    state["Bo"] = Bo
    state["DL2"] = pd.DataFrame(calc_dl(Bo.values, A_np, L_bits, paths, n),
                                index=state["A_matrix"].index, columns=state["A_matrix"].columns)

    if out:
        print("–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π:")
        print(f"–ù–∞—á–∞–ª—å–Ω–∞—è O: {default_O:.3f}")
        print(f"–§–∏–Ω–∞–ª—å–Ω–∞—è O: {best_O:.3f}")
        print(Bo)

    if out_graph_O:
        plt.plot(sp_iteration, sp_o)
        plt.xlabel("–ù–æ–º–µ—Ä –∏—Ç–µ—Ä–∞—Ü–∏–∏")
        plt.ylabel("–ó–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏")
        plt.grid(True)
        plt.show()

    return Bo


# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel
def save_to_excel(state, path="network_results_single_sheet.xlsx"):
    """–°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å—ë –≤ EXCEL —Ç–∞–±–ª–∏—Ü–∞–º–∏"""
    excel_file = path

    with pd.ExcelWriter(excel_file, engine="xlsxwriter") as writer:
        start_row = 0

        # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—Ç—Ä–∏—Ü –¥–ª—è –∑–∞–ø–∏—Å–∏ (–±–µ—Ä—ë–º –∏–∑ state)
        matrices = [
            ("1. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ Y_i", state["dataIntencity"].to_frame(name="Y_i")),
            ("2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ k_ij", state["dataKij"].to_frame(name="k_ij")),
            ("3. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞", state["matrixIntencity"]),
            ("4. –ú–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è)", state["R"]),
            ("–ú–∞—Ç—Ä–∏—Ü–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —É–∑–ª–æ–≤ (Next)", state["matrixNext"]),
            ("5. –ú–∞—Ç—Ä–∏—Ü–∞ –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –ª–∏–Ω–∏–∏ —Å–≤—è–∑–∏ Y_tilde", state["matrixNagruzka"]),
            ("6. –ú–∞—Ç—Ä–∏—Ü–∞ —Ç—Ä–µ–±—É–µ–º–æ–≥–æ —á–∏—Å–ª–∞ –∫–∞–Ω–∞–ª–æ–≤ V[i,j]", state["V_matrix"]),
            ("7. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –ü–î A[i,j] (–±–∏—Ç/—Å)", state["A_matrix"]),
            ("8. –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ª–∏–Ω–∏–π B[i,j]", state["B_matrix"]),
            ("9. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Bo", state["Bo"]),
            ("–ó–∞–¥–µ—Ä–∂–∫–∏ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ DL (–º—Å)", state["DL2"]),
        ]

        for title, df in matrices:
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            pd.DataFrame([title]).to_excel(writer, sheet_name="Results", index=False, header=False, startrow=start_row)
            start_row += 1

            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É
            df.to_excel(writer, sheet_name="Results", startrow=start_row)
            start_row += len(df) + 2  # +2: –æ–¥–Ω–∞ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ + –º–µ—Å—Ç–æ –ø–æ–¥ —Å—É–º–º—É

            # –°—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            total = df.values.sum()
            sum_df = pd.DataFrame([["–°—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π", total]])
            sum_df.to_excel(writer, sheet_name="Results", index=False, header=False, startrow=start_row)
            start_row += 3  # –æ—Ç—Å—Ç—É–ø –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –º–∞—Ç—Ä–∏—Ü–µ–π

    print(f"–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {excel_file}")
    return 1


state = load_data("data/only_matrix.csv", "data/Distribution.csv")

intensity_traffic(state, out=True)
distribution_coefficients(state)
matrix_intensity_traffic(state)
algorhitm_floid(state)
calc_link_load(state)
matrix_v(state)
matrix_a(state)
matrix_b(state)
optimization(state, out=True, out_graph_O=True)
save_to_excel(state, path="DATA1.xlsx")



```